<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Amrito Dey â€” Kinetic Profile (v3)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Three.js for 3D Background -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;600;900&family=JetBrains+Mono:wght@400;700&family=Orbitron:wght@400;700;900&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --bg: #030304;
        --cyan: #00f3ff;
        --purple: #bc13fe;
        --gold: #ffd700;
        --danger: #ff2a2a;
        --panel: rgba(10, 11, 16, 0.85);
      }

      body {
        margin: 0;
        background: var(--bg);
        color: #e6eef6;
        font-family: "Inter", sans-serif;
        overflow: hidden;
        height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      /* CRT Scanline Overlay */
      .scanlines {
        position: fixed;
        inset: 0;
        background: linear-gradient(
          to bottom,
          rgba(255, 255, 255, 0),
          rgba(255, 255, 255, 0) 50%,
          rgba(0, 0, 0, 0.2) 50%,
          rgba(0, 0, 0, 0.2)
        );
        background-size: 100% 4px;
        pointer-events: none;
        z-index: 999;
        opacity: 0.15;
      }

      /* Stage Container */
      #stage {
        position: relative;
        width: 100%;
        max-width: 1400px;
        aspect-ratio: 16/9;
        background: radial-gradient(circle at center, #0f1014 0%, #000000 100%);
        box-shadow: 0 0 80px rgba(0, 243, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.05);
        overflow: hidden;
        border-radius: 8px;
      }
      
      @media (max-width: 768px) {
        #stage {
            width: 100%;
            height: 100%;
            border-radius: 0;
            aspect-ratio: auto;
        }
      }

      /* Typography */
      .font-tech { font-family: "Orbitron", sans-serif; }
      .font-mono { font-family: "JetBrains Mono", monospace; }

      /* Glitch Animations */
      @keyframes glitch-anim-1 {
        0% { clip-path: inset(20% 0 80% 0); transform: translate(-2px, 1px); }
        20% { clip-path: inset(60% 0 10% 0); transform: translate(2px, -1px); }
        40% { clip-path: inset(40% 0 50% 0); transform: translate(-2px, 2px); }
        60% { clip-path: inset(80% 0 5% 0); transform: translate(2px, -2px); }
        80% { clip-path: inset(10% 0 70% 0); transform: translate(-1px, 1px); }
        100% { clip-path: inset(30% 0 50% 0); transform: translate(1px, -1px); }
      }
      
      .glitch-text {
        position: relative;
        display: inline-block;
      }
      .glitch-text::before, .glitch-text::after {
        content: attr(data-text);
        position: absolute;
        top: 0; left: 0; width: 100%; height: 100%;
        background: var(--bg);
      }
      .glitch-text::before {
        left: 2px;
        text-shadow: -1px 0 var(--purple);
        clip-path: inset(0 0 0 0);
        animation: glitch-anim-1 2.5s infinite linear alternate-reverse;
        opacity: 0.7;
      }
      .glitch-text::after {
        left: -2px;
        text-shadow: -1px 0 var(--cyan);
        clip-path: inset(0 0 0 0);
        animation: glitch-anim-1 3s infinite linear alternate-reverse;
        opacity: 0.7;
      }

      /* UI Layers */
      #ui-layer {
        position: absolute;
        inset: 0;
        z-index: 10;
        pointer-events: none;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        padding: 2rem;
      }

      .hud-panel {
        background: rgba(10, 15, 20, 0.6);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255,255,255,0.08);
        padding: 8px 16px;
        border-radius: 4px;
        display: inline-flex;
        align-items: center;
        gap: 10px;
        font-size: 12px;
        letter-spacing: 1px;
        pointer-events: auto;
        transition: all 0.3s ease;
      }
      .hud-panel:hover {
        border-color: var(--cyan);
        box-shadow: 0 0 15px rgba(0, 243, 255, 0.2);
      }

      /* Progress Bar */
      .progress-container {
        position: absolute;
        bottom: 0; left: 0; right: 0;
        height: 4px;
        background: #111;
        z-index: 50;
      }
      .progress-fill {
        height: 100%;
        width: 0%;
        background: linear-gradient(90deg, var(--cyan), var(--purple), var(--cyan));
        background-size: 200% 100%;
        animation: gradientMove 2s linear infinite;
        box-shadow: 0 -2px 10px var(--cyan);
      }
      @keyframes gradientMove { 0% { background-position: 100% 0; } 100% { background-position: -100% 0; } }

      /* Start Screen */
      #start-screen {
        position: absolute;
        inset: 0;
        z-index: 100;
        background: rgba(0,0,0,0.85);
        backdrop-filter: blur(20px);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        transition: opacity 0.8s ease;
      }
      
      .btn-primary {
        margin-top: 2rem;
        background: transparent;
        border: 1px solid var(--cyan);
        color: var(--cyan);
        padding: 1rem 3rem;
        font-family: "Orbitron", sans-serif;
        font-weight: 700;
        letter-spacing: 4px;
        cursor: pointer;
        text-transform: uppercase;
        position: relative;
        overflow: hidden;
        transition: all 0.3s;
      }
      .btn-primary:hover {
        background: var(--cyan);
        color: #000;
        box-shadow: 0 0 40px var(--cyan);
      }

      /* Scene Transition Styles */
      .scene-content {
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        opacity: 0;
        transform: scale(0.95);
        transition: opacity 0.6s cubic-bezier(0.2, 0.8, 0.2, 1), transform 0.6s cubic-bezier(0.2, 0.8, 0.2, 1);
      }
      .scene-active {
        opacity: 1;
        transform: scale(1);
      }

      /* Code Block Styling */
      .code-editor {
        background: #0d0e12;
        border-left: 3px solid var(--purple);
        padding: 20px;
        border-radius: 0 8px 8px 0;
        font-family: "JetBrains Mono", monospace;
        font-size: 14px;
        box-shadow: 20px 20px 60px rgba(0,0,0,0.5);
        min-width: 300px;
      }
      .syntax-keyword { color: #ff79c6; }
      .syntax-string { color: #f1fa8c; }
      .syntax-def { color: #8be9fd; }
      .cursor {
        display: inline-block;
        width: 8px;
        height: 16px;
        background: var(--cyan);
        animation: blink 1s step-end infinite;
      }
      @keyframes blink { 50% { opacity: 0; } }
      
      /* 3D Card Effect */
      .card-3d {
        background: rgba(255,255,255,0.03);
        border: 1px solid rgba(255,255,255,0.1);
        padding: 2rem;
        border-radius: 12px;
        transform-style: preserve-3d;
        transform: perspective(1000px) rotateY(0deg);
        transition: transform 0.2s;
      }

    </style>
  </head>
  <body>

    <!-- Retro Scanline Overlay -->
    <div class="scanlines"></div>

    <!-- Main Stage -->
    <div id="stage">
      <!-- Three.js Canvas -->
      <canvas id="canvas-3d" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0;"></canvas>

      <!-- Scene Container -->
      <div id="scene-root" style="position: absolute; inset: 0; z-index: 5; pointer-events: none; display: flex; align-items: center; justify-content: center;">
        <!-- Dynamic Content injected here -->
      </div>

      <!-- UI HUD -->
      <div id="ui-layer">
        <!-- Top Bar -->
        <div class="flex justify-between w-full">
          <div class="hud-panel font-mono">
            <div class="w-2 h-2 rounded-full bg-red-500 animate-pulse"></div>
            <span id="timer">00:00:00</span>
          </div>
          <div class="hud-panel font-tech text-xs text-cyan-400 border-cyan-900">
            SYSTEM: ONLINE
          </div>
        </div>

        <!-- Bottom Controls -->
        <div class="flex justify-between items-end w-full">
          <div class="flex gap-2">
            <button id="btn-pause" class="hud-panel font-mono hover:bg-white/10 cursor-pointer text-xs">PAUSE [SPC]</button>
            <button id="btn-mute" class="hud-panel font-mono hover:bg-white/10 cursor-pointer text-xs">MUTE [M]</button>
          </div>
          <button id="btn-download" class="hud-panel font-mono text-cyan-400 border-cyan-900 hover:bg-cyan-900/30 cursor-pointer">
            DOWNLOAD_ARCHIVE
          </button>
        </div>
      </div>

      <!-- Progress Line -->
      <div class="progress-container">
        <div id="progress-bar" class="progress-fill"></div>
      </div>

      <!-- Start Overlay -->
      <div id="start-screen">
        <div class="text-center">
          <div class="font-mono text-xs text-gray-500 mb-4 tracking-widest">IMMERSIVE PORTFOLIO PROTOCOL V3</div>
          <h1 class="font-tech text-6xl md:text-8xl text-white glitch-text" data-text="AMRITO DEY" style="margin: 0;">AMRITO DEY</h1>
          <button id="btn-start" class="btn-primary">INITIALIZE</button>
          <div class="mt-6 font-mono text-xs text-gray-600">HEADPHONES RECOMMENDED</div>
        </div>
      </div>
    </div>

    <script>
      /* ================================================================
        SYSTEM CORE: AUDIO, VISUALS, TIMELINE
        ================================================================
      */

      const state = {
        started: false,
        paused: false,
        muted: false,
        startTime: 0,
        pauseTime: 0,
        totalOffset: 0,
        duration: 45000 // 45 seconds total run
      };

      const dom = {
        stage: document.getElementById('stage'),
        root: document.getElementById('scene-root'),
        startScreen: document.getElementById('start-screen'),
        timer: document.getElementById('timer'),
        progress: document.getElementById('progress-bar'),
        btnStart: document.getElementById('btn-start'),
        btnPause: document.getElementById('btn-pause'),
        btnMute: document.getElementById('btn-mute'),
        btnDownload: document.getElementById('btn-download')
      };

      // ==========================================
      // 1. THREE.JS VISUAL CORE
      // ==========================================
      const visualCore = {
        scene: null, camera: null, renderer: null,
        sphere: null, particles: null,
        mouseX: 0, mouseY: 0,
        
        init() {
          const canvas = document.getElementById('canvas-3d');
          this.scene = new THREE.Scene();
          this.scene.fog = new THREE.FogExp2(0x000000, 0.002);

          this.camera = new THREE.PerspectiveCamera(75, dom.stage.clientWidth / dom.stage.clientHeight, 0.1, 1000);
          this.camera.position.z = 30;

          this.renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });
          this.renderer.setSize(dom.stage.clientWidth, dom.stage.clientHeight);
          this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

          // Create Neural Globe (Wireframe Icosahedron)
          const geometry = new THREE.IcosahedronGeometry(10, 2);
          const material = new THREE.MeshBasicMaterial({ 
            color: 0x222222, 
            wireframe: true,
            transparent: true,
            opacity: 0.3
          });
          this.sphere = new THREE.Mesh(geometry, material);
          this.scene.add(this.sphere);

          // Floating Data Particles
          const pGeo = new THREE.BufferGeometry();
          const pCount = 800;
          const posArray = new Float32Array(pCount * 3);
          for(let i=0; i<pCount*3; i++) {
            posArray[i] = (Math.random() - 0.5) * 100;
          }
          pGeo.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
          const pMat = new THREE.PointsMaterial({
            size: 0.15,
            color: 0x00f3ff,
            transparent: true,
            opacity: 0.8,
            blending: THREE.AdditiveBlending
          });
          this.particles = new THREE.Points(pGeo, pMat);
          this.scene.add(this.particles);

          // Ambient Light
          const ambientLight = new THREE.AmbientLight(0x404040);
          this.scene.add(ambientLight);

          // Resize Handler
          window.addEventListener('resize', () => {
            this.camera.aspect = dom.stage.clientWidth / dom.stage.clientHeight;
            this.camera.updateProjectionMatrix();
            this.renderer.setSize(dom.stage.clientWidth, dom.stage.clientHeight);
          });

          // Mouse Parallax
          dom.stage.addEventListener('mousemove', (e) => {
            const rect = dom.stage.getBoundingClientRect();
            this.mouseX = ((e.clientX - rect.left) / rect.width) * 2 - 1;
            this.mouseY = -((e.clientY - rect.top) / rect.height) * 2 + 1;
          });

          this.animate();
        },

        animate() {
          requestAnimationFrame(() => this.animate());
          
          const time = performance.now() * 0.001;

          // Rotate Sphere
          if (this.sphere) {
            this.sphere.rotation.x += 0.001;
            this.sphere.rotation.y += 0.002;
            // Breathing effect
            const scale = 1 + Math.sin(time) * 0.05;
            this.sphere.scale.set(scale, scale, scale);
          }

          // Rotate Particles
          if (this.particles) {
            this.particles.rotation.y = -time * 0.05;
          }

          // Camera Parallax
          this.camera.position.x += (this.mouseX * 2 - this.camera.position.x) * 0.05;
          this.camera.position.y += (this.mouseY * 2 - this.camera.position.y) * 0.05;
          this.camera.lookAt(this.scene.position);

          this.renderer.render(this.scene, this.camera);
        },

        // Effects triggers
        warpSpeed() {
          // Temporary speed up particles
          // Implementation simplified for stability
        }
      };

      // ==========================================
      // 2. CINEMATIC AUDIO ENGINE
      // ==========================================
      const audioCore = {
        ctx: null,
        master: null,
        droneNode: null,
        filterNode: null,

        init() {
          const AC = window.AudioContext || window.webkitAudioContext;
          this.ctx = new AC();
          this.master = this.ctx.createGain();
          this.master.gain.value = 0.2; // Base volume
          this.master.connect(this.ctx.destination);

          // Drone (Background Hum)
          this.droneNode = this.ctx.createOscillator();
          this.droneNode.type = 'sawtooth';
          this.droneNode.frequency.value = 50;
          
          // Lowpass filter for "Underwater" feel
          this.filterNode = this.ctx.createBiquadFilter();
          this.filterNode.type = 'lowpass';
          this.filterNode.frequency.value = 200;

          this.droneNode.connect(this.filterNode);
          this.filterNode.connect(this.master);
          this.droneNode.start();

          // LFO for filter movement
          const lfo = this.ctx.createOscillator();
          lfo.frequency.value = 0.1;
          const lfoGain = this.ctx.createGain();
          lfoGain.gain.value = 150;
          lfo.connect(lfoGain);
          lfoGain.connect(this.filterNode.frequency);
          lfo.start();
        },

        playSfx(type) {
          if (!this.ctx) return;
          const osc = this.ctx.createOscillator();
          const gain = this.ctx.createGain();
          
          osc.connect(gain);
          gain.connect(this.master);

          const now = this.ctx.currentTime;

          if (type === 'glitch') {
            // White noise burst approximation
            osc.type = 'square';
            osc.frequency.setValueAtTime(Math.random() * 1000 + 200, now);
            osc.frequency.exponentialRampToValueAtTime(100, now + 0.1);
            gain.gain.setValueAtTime(0.1, now);
            gain.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
            osc.start(now);
            osc.stop(now + 0.1);
          } else if (type === 'boom') {
            // Deep impact
            osc.type = 'sine';
            osc.frequency.setValueAtTime(150, now);
            osc.frequency.exponentialRampToValueAtTime(40, now + 0.5);
            gain.gain.setValueAtTime(0.5, now);
            gain.gain.exponentialRampToValueAtTime(0.01, now + 0.8);
            osc.start(now);
            osc.stop(now + 0.8);
          } else if (type === 'type') {
            // High ping
            osc.type = 'triangle';
            osc.frequency.value = 800;
            gain.gain.setValueAtTime(0.05, now);
            gain.gain.exponentialRampToValueAtTime(0.01, now + 0.05);
            osc.start(now);
            osc.stop(now + 0.05);
          }
        },

        toggleMute(isMuted) {
            if(this.master) this.master.gain.value = isMuted ? 0 : 0.2;
        }
      };

      // ==========================================
      // 3. TIMELINE & SCENE MANAGER
      // ==========================================
      
      // Utility: Typewriter effect
      function typeWriter(elementId, text, speed = 50) {
        const el = document.getElementById(elementId);
        if(!el) return;
        el.innerHTML = '';
        let i = 0;
        function type() {
            if (i < text.length) {
                el.innerHTML += text.charAt(i);
                i++;
                // Random typing variation
                if(Math.random() > 0.8) audioCore.playSfx('type'); 
                setTimeout(type, speed + (Math.random() * 30));
            }
        }
        type();
      }

      const scenes = [
        {
          // 0: INTRO
          at: 0,
          render: (el) => {
            el.innerHTML = `
              <div class="scene-content scene-active text-center">
                <div class="font-mono text-cyan-400 text-sm tracking-[0.5em] mb-4">IDENTITY_CONFIRMED</div>
                <h1 class="font-tech text-7xl md:text-9xl font-black glitch-text" data-text="AMRITO DEY">AMRITO DEY</h1>
                <div class="flex items-center justify-center gap-4 mt-6">
                   <span class="px-3 py-1 border border-gray-700 rounded text-xs font-mono text-gray-400">EST. 2006</span>
                   <span class="px-3 py-1 border border-gray-700 rounded text-xs font-mono text-gray-400">BD_REGION</span>
                </div>
              </div>
            `;
            audioCore.playSfx('boom');
          }
        },
        {
          // 1: SKILLS (The Builder)
          at: 3500,
          render: (el) => {
            el.innerHTML = `
              <div class="scene-content scene-active flex flex-col md:flex-row gap-12 items-center">
                 <div class="text-right">
                    <h2 class="font-tech text-4xl md:text-6xl text-white mb-2">FULL STACK<br/><span class="text-cyan-400">ARCHITECT</span></h2>
                    <p class="font-mono text-gray-400 text-sm">Building digital reality.</p>
                 </div>
                 <div class="code-editor">
                    <div class="flex gap-2 mb-4 border-b border-gray-800 pb-2">
                        <div class="w-3 h-3 rounded-full bg-red-500"></div>
                        <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                        <div class="w-3 h-3 rounded-full bg-green-500"></div>
                    </div>
                    <div id="code-target"></div>
                    <span class="cursor"></span>
                 </div>
              </div>
            `;
            // Trigger typing slightly after render
            setTimeout(() => {
                const code = `<span class="syntax-keyword">const</span> <span class="syntax-def">stack</span> = {\n  lang: [<span class="syntax-string">'JS'</span>, <span class="syntax-string">'Python'</span>],\n  frame: [<span class="syntax-string">'React'</span>, <span class="syntax-string">'Three.js'</span>],\n  db: <span class="syntax-string">'MongoDB'</span>\n};`;
                // Simple simulation of typing complex HTML
                const target = document.getElementById('code-target');
                target.innerHTML = code; 
                // Use simple reveal animation for HTML content to avoid parsing issues
                target.style.opacity = 0;
                target.animate([{opacity:0}, {opacity:1}], {duration: 500, fill:'forwards'});
                audioCore.playSfx('type');
            }, 500);
          }
        },
        {
          // 2: ORIGIN (The Struggle)
          at: 8500,
          render: (el) => {
            el.innerHTML = `
              <div class="scene-content scene-active text-center">
                 <div class="font-mono text-red-500 mb-2">System Alert: OBSTACLE_DETECTED</div>
                 <h2 class="font-tech text-5xl md:text-7xl text-white mb-6">RELOCATED >> CUMILLA</h2>
                 <div class="inline-block p-6 border border-red-500/30 bg-red-900/10 backdrop-blur">
                    <p class="font-mono text-lg text-red-200">STATUS: FINANCIAL_PRESSURE</p>
                    <p class="font-mono text-lg text-white font-bold mt-2">RESPONSE: GRIND_HARDER</p>
                 </div>
              </div>
            `;
            audioCore.playSfx('glitch');
          }
        },
        {
          // 3: VENTURES (Cards)
          at: 13500,
          render: (el) => {
            el.innerHTML = `
              <div class="scene-content scene-active flex flex-col items-center">
                 <h3 class="font-mono text-cyan-400 mb-8 tracking-widest">ACTIVE DEPLOYMENTS</h3>
                 <div class="flex flex-wrap justify-center gap-8">
                    <div class="card-3d text-center w-64">
                        <div class="text-6xl mb-4">ðŸŽ“</div>
                        <h4 class="font-tech text-xl font-bold">MENTORLY</h4>
                        <p class="font-mono text-xs text-gray-400 mt-2">AI-Powered Education Assistant</p>
                    </div>
                    <div class="card-3d text-center w-64" style="border-color: var(--purple)">
                        <div class="text-6xl mb-4">ðŸ§ </div>
                        <h4 class="font-tech text-xl font-bold">SYNAPSE</h4>
                        <p class="font-mono text-xs text-gray-400 mt-2">Collective Intelligence Network</p>
                    </div>
                 </div>
              </div>
            `;
            audioCore.playSfx('boom');
          }
        },
        {
          // 4: THE DREAM (Gold)
          at: 19000,
          render: (el) => {
            el.innerHTML = `
              <div class="scene-content scene-active text-center">
                 <div style="
                    position: absolute; width: 300px; height: 300px; 
                    background: radial-gradient(circle, rgba(255,215,0,0.2) 0%, rgba(0,0,0,0) 70%);
                    filter: blur(40px); z-index: -1;">
                 </div>
                 <h2 class="font-tech text-6xl md:text-8xl text-yellow-400 tracking-widest mb-2">DUBAI</h2>
                 <div class="font-mono text-white text-xl tracking-widest uppercase border-t border-yellow-500/50 pt-4 mt-2">
                    Target Destination
                 </div>
              </div>
            `;
             audioCore.playSfx('boom');
          }
        },
        {
          // 5: VISION
          at: 24000,
          render: (el) => {
             el.innerHTML = `
              <div class="scene-content scene-active w-full max-w-4xl px-8">
                 <div class="font-mono text-gray-500 mb-8">LOADING_MANIFESTO...</div>
                 <div class="space-y-6">
                    <div class="flex items-center gap-4 opacity-0" style="animation: slideIn 0.5s forwards 0.2s">
                        <span class="text-cyan-400 font-bold text-2xl">></span>
                        <span class="font-tech text-3xl md:text-4xl">DECENTRALIZED AI</span>
                    </div>
                    <div class="flex items-center gap-4 opacity-0" style="animation: slideIn 0.5s forwards 0.6s">
                        <span class="text-cyan-400 font-bold text-2xl">></span>
                        <span class="font-tech text-3xl md:text-4xl">HUMANOID ROBOTICS</span>
                    </div>
                    <div class="flex items-center gap-4 opacity-0" style="animation: slideIn 0.5s forwards 1.0s">
                        <span class="text-cyan-400 font-bold text-2xl">></span>
                        <span class="font-tech text-3xl md:text-4xl text-purple-400">GLOBAL IMPACT</span>
                    </div>
                 </div>
                 <style>
                    @keyframes slideIn { from { transform: translateX(-50px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
                 </style>
              </div>
            `;
            audioCore.playSfx('type');
          }
        },
        {
          // 6: OUTRO
          at: 30000,
          render: (el) => {
             el.innerHTML = `
              <div class="scene-content scene-active text-center">
                 <p class="font-mono text-cyan-400 mb-4">SEQUENCE COMPLETE</p>
                 <h1 class="font-tech text-6xl md:text-8xl text-white mb-8 glitch-text" data-text="AMRITO DEY">AMRITO DEY</h1>
                 <div class="flex gap-4 justify-center">
                    <button onclick="window.location.reload()" class="px-6 py-3 border border-white/20 hover:bg-white/10 font-mono rounded transition pointer-events-auto">REPLAY</button>
                    <button onclick="openShare()" class="px-6 py-3 bg-cyan-500/20 border border-cyan-400 hover:bg-cyan-500/40 text-cyan-300 font-mono rounded transition pointer-events-auto">SHARE PROFILE</button>
                 </div>
              </div>
            `;
             audioCore.playSfx('boom');
          }
        }
      ];

      // ==========================================
      // 4. MAIN LOOP
      // ==========================================
      
      let animationFrame;
      let currentSceneIndex = -1;

      function startTimeline() {
        if (state.started) return;
        
        // Init systems
        audioCore.init();
        visualCore.init();
        
        // UI Transition
        dom.startScreen.style.opacity = 0;
        setTimeout(() => dom.startScreen.style.display = 'none', 800);
        
        state.started = true;
        state.startTime = performance.now();
        
        loop();
      }

      function loop() {
        if (state.paused) {
            animationFrame = requestAnimationFrame(loop);
            return;
        }

        const now = performance.now();
        const elapsed = now - state.startTime - state.totalOffset;

        if (elapsed > state.duration) {
            // End state if needed, but Outro usually holds
        }

        // Scene Management
        // Find the latest scene that should be active
        let activeIndex = -1;
        for(let i=0; i<scenes.length; i++) {
            if (elapsed >= scenes[i].at) activeIndex = i;
        }

        if (activeIndex !== currentSceneIndex && activeIndex !== -1) {
            currentSceneIndex = activeIndex;
            scenes[activeIndex].render(dom.root);
        }

        // Update Timer & Progress
        const sec = Math.floor(elapsed / 1000);
        const ms = Math.floor((elapsed % 1000) / 10);
        dom.timer.innerText = `00:${sec < 10 ? '0'+sec : sec}:${ms < 10 ? '0'+ms : ms}`;
        
        const pct = Math.min((elapsed / 32000) * 100, 100); // 32s is roughly end of content
        dom.progress.style.width = `${pct}%`;

        animationFrame = requestAnimationFrame(loop);
      }

      // ==========================================
      // 5. CONTROLS
      // ==========================================
      
      dom.btnStart.addEventListener('click', startTimeline);
      
      dom.btnPause.addEventListener('click', togglePause);
      document.addEventListener('keydown', (e) => {
        if (e.code === 'Space') togglePause();
        if (e.key === 'm' || e.key === 'M') toggleMute();
      });

      function togglePause() {
        if(!state.started) return;
        state.paused = !state.paused;
        dom.btnPause.innerText = state.paused ? "RESUME [SPC]" : "PAUSE [SPC]";
        
        if(state.paused) {
            state.pauseTime = performance.now();
            if(audioCore.ctx) audioCore.ctx.suspend();
        } else {
            state.totalOffset += (performance.now() - state.pauseTime);
            if(audioCore.ctx) audioCore.ctx.resume();
        }
      }

      function toggleMute() {
        state.muted = !state.muted;
        audioCore.toggleMute(state.muted);
        dom.btnMute.innerText = state.muted ? "UNMUTE [M]" : "MUTE [M]";
        dom.btnMute.style.color = state.muted ? "red" : "white";
      }

      dom.btnDownload.addEventListener('click', () => {
        const html = document.documentElement.outerHTML;
        const blob = new Blob([html], { type: "text/html" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "Amrito_Dey_Profile_v3.html";
        a.click();
      });

      window.openShare = function() {
        alert("Profile URL copied to clipboard (Simulation)");
      }

      // Initial console signature
      console.log("%c AMRITO DEY // SYSTEM V3 READY", "background: #000; color: #00f3ff; font-size: 12px; padding: 4px;");

    </script>
  </body>
</html>